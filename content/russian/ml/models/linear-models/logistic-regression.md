---
title: Логистическая регрессия
---

В прошлой \<\<главе>\> мы научились решать задачи *регрессии* с помощью
*линейной регресии*. Возникает очевидный вопрос: как же тогда решать
задачу *классификации*? Попробуем обобщить модель *линейной регрессии*
на *классификацию*.

## Модель

Давайте, для начала, рассмотрим задачу *бинарной классификации*.

Что будет, если мы просто предскажем 0 или 1 с помощью *линейной
регрессии*? Скажем, что значения, большие 0.5 относятся к *первому
классу*, меньшие - к *второму* классу.

При таком подходе модель никак не учитывает свою *\<\<уверенность>\>* в
ответе. Мы не увидим отличие, между значением, равным 0.5 и равным 1000.
Хотелось бы научиться получать **вероятность принадлежности к классу
1**.

Давайте преобразовывать ответ модели, который находится в интервале
$(-\infty;+\infty)$ в ответ из интервала $(0; 1)$. Такие преобразования
называются **сигмоидами**.

![](img/sigmoid.png)

Обычно используют сигмоиду $\sigma(y) = \frac{1}{1 + e^{-y}}$.

## Функция потерь

Так как у нашей модели изменились ответы, нам необходимо поменять
функцию ошибки. Давайте посмотрим на предсказания модели и вычислим
вероятность того, что модель \<\<угадает>\> классы для всех объектов.

$$P_{all} = \prod_{i | y_i=1}p_i \prod_{i | y_i=0}(1 - p_i)$$

Нам необходимо максимизировать эту вероятность.

Работать с произведением неудобно, поэтому возьмем логарифм.

$$\ln{P_{all}} = \sum_{i | y_i=1}\ln{p_i} + \sum_{i | y_i=0}\ln(1 - p_i)$$

Если взять данное значение с отрицанием, получится наша новая функция
потерь - **Logloss**.

$$Logloss = -\ln{P_{all}} = -\sum_{i | y_i=1}\ln{p_i} - \sum_{i | y_i=0}\ln(1 - p_i)$$

Описанный алгоритм называется **Логистическая регрессия** и служит для
бинарной классификации.

## Мультиклассовая классификация

Если мы имеем задачу мультиклассовой классификации с **n** классами,
давайте обучим $n$ логистических регрессий, в $i$-й логистической
регресии будем предсказывать вероятность, что объект относится к классу
$i$.

Как ответ можно взять класс с максимальной вероятностью.
